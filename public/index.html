<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<style>
			* {
				box-sizing: border-box;
			}
			html, body {
				display: flex;
				flex-direction: column;
				justify-content: stretch;
				height: 100%;
				margin: 0;
			}
			#app {
				position: relative;
				display: flex;
				flex: 1;
				justify-content: center;
				background: #316;
			}
			#app > canvas {
				position: absolute;
				width: 100%;
				height: 100%;
				image-rendering: pixelated;
			}
			#settings {
				position: fixed;
				z-index: 1000;
				top: 2em;
				right: 2em;
				color: #fff;
				font-family: sans-serif;
				background: rgba(0, 0, 0, 0.8);
				border-radius: 4px;
				padding: 1em;
				display: flex;
				flex-direction: column;
			}
			#settings label {
				user-select: none;
			}
			#settings label input,
			#settings label select {
				width: 5em;
				margin: 0;
			}
			#settings label input[type="number"] {
				text-align: right;
			}
			#settings label + label {
				margin-top: 0.3em;
			}
			#settings p {
				margin: 0 0 0.3em 0;
			}
			#settings #fps {
				margin-top: 0.5em;
			}
		</style>
	</head>
	<body>
		<div id="app">
			<canvas></canvas>
			<div id="settings">
				<p><strong>WASD</strong> to move.<br>Click and drag to rotate.</p>
				<p>Reload for different colours</p>
				<label><input checked type="checkbox" id="enable-edges" /> Edges</label>
				<label><input type="number" id="dither-size" value="2" min="0" max="8" /> Dither Size</label>
				<label><input type="number" id="dither-depth" value="3" min="1" max="128" /> Dither Depth</label>
				<label>
					<select id="render-mode">
						<option>Full</option>
						<option>Shading</option>
						<option>Albedo</option>
						<option>Normals</option>
						<option>Position</option>
						<option>Depth</option>
					</select>
					Render Mode
				</label>
				<div id="fps">Framerate: <span></span></div>
			</div>
		</div>
		<script type="module">
			const { main } = await import('./bundle.js');
			const gfx = await main(document.querySelector('#app canvas'))
			const fps = document.querySelector('#fps span');
			const ditherSizeInp = document.querySelector('#dither-size');
			const ditherDepthInp = document.querySelector('#dither-depth');
			const edgesChk = document.querySelector('#enable-edges');
			const modeSel = document.querySelector('#render-mode');
			function updateSettings() {
				gfx.configure({
					ditherSize: parseInt(ditherSizeInp.value),
					ditherDepth: parseInt(ditherDepthInp.value),
					drawEdges: edgesChk.checked,
					renderMode: modeSel.selectedIndex,
				});
			}
			updateSettings();
			ditherSizeInp.addEventListener('click', updateSettings);
			ditherDepthInp.addEventListener('click', updateSettings);
			edgesChk.addEventListener('click', updateSettings);
			modeSel.addEventListener('change', updateSettings);
			setInterval(() => fps.innerHTML = gfx.fps.toFixed(0), 200);
		</script>
	</body>
</html>

